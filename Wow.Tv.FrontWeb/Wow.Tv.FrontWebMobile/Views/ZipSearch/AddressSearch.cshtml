@model string

<div class="popup-area" id="AddressSearchPopupFrame">
    <div class="dimBg"></div>
    <div id="AddressSearchPopup" class="pop-layer">
        <div class="title-area">
            <strong class="title">우편번호 찾기</strong>
        </div>
        <div class="content-area">
            <div class="pop-tab-type col2">
                <ul>
                    <li class="on" id="liAddressSearchGoRoad"><a href="#" id="addressSearchGoRoad">도로명 주소로 찾기</a></li>
                    <li id="liAddressSearchGoReviseDomain"><a href="#" id="addressSearchGoReviseDomain">지번 주소로 찾기</a></li>
                </ul>
            </div>
            <div class="section" id="AddressSearchLayerByRoad">
                <p class="text">도로명 주소를 모르실 경우, <a href="#none" class="text-link-type1">http://www.juso.go.kr/</a>에서 정확한 주소를 확인하세요.</p>

                <div class="box-find-addr-form">
                    <input type="text" placeholder="도로명 주소를 입력하세요." id="addressSearchKeywordInputByRoad" />
                    <div class="btn-area">
                        <input type="submit" class="btn" value="검색" id="addressSearchSubmitByRoad" />
                    </div>
                </div>
                <h3 class="title font-color00">검색방법</h3>
                <div class="list-type1 mt0">
                    <ol>
                        <li><span class="num">1.</span>도로명으로 검색하세요. <strong class="font-color03">예) 버드나루로84 (O)</strong></li>
                        <li>
                            <span class="num">2.</span>도로명 + 건물번호로 검색하세요.<br>
                            주소가 “서울시 송파구 잠실로 51-33”인 경우.<br><strong class="font-color03">예)잠실로 51-33</strong><br>
                            ※ 지번주소, 동/리명만으로는 검색되지 않습니다.<br><strong class="font-color03">예) 영등포동7가 (X)</strong>
                        </li>
                    </ol>
                </div>
                <div class="table-type2 pop-type mt15">
                    <table id="addressSearchResultByRoad">
                        <colgroup>
                            <col style="width:22%">
                            <col>
                        </colgroup>
                        <thead>
                            <tr>
                                <th>우편번호</th>
                                <th>주소</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="txt-paging" id="addressSearchPagingByRoad">
                    <a href="javascript:void(0)" class="first">FIRST</a>
                    <a href="javascript:void(0)" class="prev">PREV</a>
                    <div>
                        <a href="javascript:void(0)">1</a>
                        <span>/</span>
                        <a href="javascript:void(0)">1</a>
                    </div>
                    <a href="javascript:void(0)" class="next">NEXT</a>
                    <a href="javascript:void(0)" class="last">LAST</a>
                </div>
            </div>
            <div class="section" id="AddressSearchLayerByReviseDomain">
                <p class="text">지번주소를 입력해 주세요.</p>
                <div class="box-find-addr-form">
                    <input type="text" placeholder="지번주소를 입력하세요." id="addressSearchKeywordInputByReviseDomain" />
                    <div class="btn-area">
                        <input type="submit" class="btn" value="검색" id="addressSearchSubmitByReviseDomain" />
                    </div>
                </div>
                <h3 class="title font-color00">검색방법</h3>
                <p class="text">주소가 "서울 송파구 잠실동"인 경우 <strong class="font-color03">예) 잠실동</strong></p>
                <div class="table-type2 pop-type mt15">
                    <table id="addressSearchResultByReviseDomain">
                        <colgroup>
                            <col style="width:22%">
                            <col>
                        </colgroup>
                        <thead>
                            <tr>
                                <th>우편번호</th>
                                <th>주소</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="txt-paging" id="addressSearchPagingByReviseDomain">
                    <a href="javascript:void(0)" class="first">FIRST</a>
                    <a href="javascript:void(0)" class="prev">PREV</a>
                    <div>
                        <a href="javascript:void(0)">1</a>
                        <span>/</span>
                        <a href="javascript:void(0)">1</a>
                    </div>
                    <a href="javascript:void(0)" class="next">NEXT</a>
                    <a href="javascript:void(0)" class="last">LAST</a>
                </div>
            </div>
        </div>
        <span class="pop-btn"><a href="#" onclick="return AddressSearchLayerClose();">닫기</a></span>
    </div>
</div>

<script type="text/javascript">

    var addressSearchLatestTab = "ROAD";

    function AddressSearchLayerOpen() {
        AddressSearchTabSelect(addressSearchLatestTab);
        AddressSearchLayerShow("#AddressSearchPopup");
    }

    function AddressSearchLayerClose() {
        $("#AddressSearchPopupFrame").fadeOut();
        return false;
    }

    function AddressSearchTabSelect(addressSearchTab) {

        var scrollTop = $(document).scrollTop();

        if (addressSearchTab == "ROAD") {
            $("#liAddressSearchGoRoad").addClass("on");
            $("#liAddressSearchGoReviseDomain").removeClass("on");
            $("#AddressSearchLayerByRoad").css("display", "block");
            $("#AddressSearchLayerByReviseDomain").css("display", "none");
        }
        else {
            $("#liAddressSearchGoRoad").removeClass("on");
            $("#liAddressSearchGoReviseDomain").addClass("on");
            $("#AddressSearchLayerByRoad").css("display", "none");
            $("#AddressSearchLayerByReviseDomain").css("display", "block");
        }

        addressSearchLatestTab = addressSearchTab;
    }

    function SelectOK(zipCode, address) {
        @(Model)(zipCode, address);
        AddressSearchLayerClose();
    }

    var AddressListByRoadData = null;
    function DoAddressSearchByRoad(pageIndex) {
        addressSearchLatestTab = "";
        var searchKeywordInput = $("#addressSearchKeywordInputByRoad").val();
        $('#addressSearchResultByRoad > tbody > tr').remove();

        $.ajax({
            type: "get",
            url: "/ZipSearch/AddressSearchByRoad",
            data: { searchkeyword: searchKeywordInput, pageindex: pageIndex },
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.DataReceived == "Y" && data.SuccessYN == "Y") {
                    if (data.AddressList.length > 0) {
                        for (rowIndex = 0; rowIndex < data.AddressList.length; rowIndex++) {
                            var zipCode = data.AddressList[rowIndex].ZipCode;
                            var address1 = data.AddressList[rowIndex].Address1;
                            var appendHtml = "<tr>" +
                                "<td><a href=\"\" onclick=\"SelectOK('" + zipCode + "', '" + address1 + "'); return false;\">" + zipCode + "</a></td>" +
                                "<td><a href=\"\" onclick=\"SelectOK('" + zipCode + "', '" + address1 + "'); return false;\">" + address1 + "</a></td>" +
                                "</tr>"
                            $('#addressSearchResultByRoad > tbody:last').append(appendHtml);
                            $("#addressSearchResultByRoad").css("display", "block");
                            $("#addressSearchPagingByRoad").html(cfGetPagingHtml(data.TotalCount, pageIndex, data.PageSize, "DoAddressSearchByRoad"));
                        }
                    }
                    else {
                        var appendHtml = "<tr>" +
                            "<td colspan=\"2\" style=\"height: 150px;\">검색결과가 없습니다.</td>" +
                            "</tr>"
                        $('#addressSearchResultByRoad > tbody:last').append(appendHtml);
                        $("#addressSearchPagingByRoad").css("display", "none");
                    }

                    AddressListByRoadData = data.AddressList;
                }
            },
            error: function (e) {
                console.log("error ==> " + JSON.stringify(e));
            }
        });

        return false;
    }

    function DoAddressSearchByReviseDomain(pageIndex) {
        addressSearchLatestTab = "";
        var searchKeywordInput = $("#addressSearchKeywordInputByReviseDomain").val();
        $('#addressSearchResultByReviseDomain > tbody > tr').remove();

        $.ajax({
            type: "get",
            url: "/ZipSearch/AddressSearchByReviseDomain",
            data: { searchkeyword: searchKeywordInput, pageindex: pageIndex },
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.DataReceived == "Y") {
                    if (data.AddressList.length > 0) {
                        for (rowIndex = 0; rowIndex < data.AddressList.length; rowIndex++) {
                            var zipCode = data.AddressList[rowIndex].ZipCode;
                            var address1 = data.AddressList[rowIndex].Address1;
                            var appendHtml = "<tr>" +
                                "<td><a href=\"\" onclick=\"SelectOK('" + zipCode + "', '" + address1 + "'); return false;\">" + zipCode + "</a></td>" +
                                "<td><a href=\"\" onclick=\"SelectOK('" + zipCode + "', '" + address1 + "'); return false;\">" + address1 + "</a></td>" +
                                "</tr>"
                            $('#addressSearchResultByReviseDomain > tbody:last').append(appendHtml);
                            $("#addressSearchPagingByReviseDomain").css("display", "block");
                            $("#addressSearchPagingByReviseDomain").html(cfGetPagingHtml(data.TotalCount, pageIndex, data.PageSize, "DoAddressSearchByReviseDomain"));
                        }
                    }
                    else {
                        var appendHtml = "<tr>" +
                            "<td colspan=\"2\" style=\"height: 150px;\">검색결과가 없습니다.</td>" +
                            "</tr>"
                        $('#addressSearchResultByReviseDomain > tbody:last').append(appendHtml);
                        $("#addressSearchPagingByReviseDomain").css("display", "none");
                    }
                }
            },
            error: function (e) {
                console.log("error ==> " + JSON.stringify(e));
            }
        });

        return false;
    }

    $("#addressSearchGoRoad").click(function () {
        AddressSearchTabSelect("ROAD");
        return false;
    });

    $("#addressSearchGoReviseDomain").click(function () {
        AddressSearchTabSelect("REVISEDOMAIN");
        return false;
    });

    $("#addressSearchSubmitByRoad").click(function () {
        DoAddressSearchByRoad(0);
        return false;
    });

    $("#addressSearchSubmitByReviseDomain").click(function () {
        DoAddressSearchByReviseDomain(0);
        return false;
    });

    $("#addressSearchKeywordInputByRoad").keydown(function () {
        if (event.keyCode == 13) {
            $("#addressSearchSubmitByRoad").click();
            return false;
        }
    });

    $("#addressSearchKeywordInputByReviseDomain").keydown(function () {
        if (event.keyCode == 13) {
            $("#addressSearchSubmitByReviseDomain").click();
            return false;
        }
    });

    function AddressSearchLayerShow(el) {

        var $el = $(el);        //레이어의 id를 $el 변수에 저장
        var isDim = $el.prev().hasClass('dimBg');   //dimmed 레이어를 감지하기 위한 boolean 변수

        isDim ? $('.popup-area').fadeIn() : $el.fadeIn();

        var $elWidth = ~~($el.outerWidth()),
            $elHeight = ~~($el.outerHeight()),
            docWidth = $(document).width(),
            docHeight = $(document).height();

        // 화면의 중앙에 레이어를 띄운다.
        if ($elHeight < docHeight || $elWidth < docWidth) {
            $el.css({
                marginTop: -$elHeight / 2,
                marginLeft: -$elWidth / 2
            })
        } else {
            $el.css({ top: 0, left: 0 });
        }

        $el.find('.pop-btn').click(function () {
            isDim ? $('.popup-area').fadeOut() : $el.fadeOut(); // 닫기 버튼을 클릭하면 레이어가 닫힌다.
            return false;
        });

        $('.layer .dimBg').click(function () {
            $('.popup-area').fadeOut();
            return false;
        });

    }
</script>
